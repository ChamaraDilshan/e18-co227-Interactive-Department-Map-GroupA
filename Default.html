<!DOCTYPE html>
<html>
<head>
    <title>My Website</title>   <!--Name of the website -->
    <link rel="stylesheet" href="style.css"/>   <!--Linking the css file-->
</head>
<body>
    <script src="./js/three.js"></script>            <!-- Importing the three.js library-->
    <script src="./js/jquery.js"></script>           <!-- Importing the jquery.js library-->
    <script src="./js/threex.domevents.js"></script> <!-- Importing the threex.domevents.js library-->
    <script src="./js/GLTFLoader.js"></script>       <!-- Importing the GLTFLoader.js library-->
    <script type="text/javascript"> 
    
        // var conn = new ActiveXObject("ADODB.Connection");
        // var conn_str = "";
        // var db_Host = "";
        // var db_User = "";
        // var db_Password = "";
        // var db_Provider = "";
        // var db_Default = "";

        // function Show_Data(){
        //     db_Host = "RUCHIRA"
        //     db_User = "root"
        //     db_Password = ""
        //     db_Provider = "SQLOLEDB"
        //     db_Default = "ex"
        //     conn_str = "Provider=" + db_Provider+";Data Source="+db_Host+"; User Id="+db_User+"; password="+db_Password+"; initial Catalog="+db_Default;
        //     show_data_from_database();
        // }

        // function show_data_from_database(){
        //     try{
        //         conn.Open(conn_str);
        //         var reader = new ActiveXObject("ADODB.Recordset");
        //         var strQuery = "SELECT * FROM USERS";
        //         reader.Open(strQuery,conn);
        //         reader.MoveFirst();
        //         while(!reader.eof){
        //             reader.fields(0);
        //             reader.fields(1);
        //             reader.movenext();
        //         }
        //     }catch(e){
        //         alert("Error");
        //     }
        // }

        var angle_x=0,angle_y=0;                //Starting rotation values of the camera
        var clicked = 0;                //To check whether a building has been clicked or not
        var expanding = 0;              //To check if top right labels are expanding or not
        var expanded = 0;               //To check whether top right main label has been expanded or not
        var circleCorners = 1;
        var out = 0;
        var X = 0.52,Y=0.7,R=0.9,S=0.08;

//Database
        //This database is used to load the information about the buildings
        var departmentDatabase;
        
        //Data of a particular room can be added to the database as an array
        var building0 = ["Department Building","<li>Welcome to Computer Engineering Department</li><li>Head of the department is Mr.Rohitha</li><li>This is a 4 story building</li>","<li>Welcome to Computer Engineering Department</li><li>University of Peradeniya</li><li>Head of the department is Mr.Rohitha (BsC .jhbasdvll)</li><li>This is a 4 story building which has 4 labs and bla bla bla</li>"];
        var building1 = ["Building 1","<li>blue colour</li><li>height-10m</li><li>Dr. Namal</li>","<li>This is a blue colour building</li><li>Height of this builing is 10m.</li><li>This building belongs to Dr. Namal</li><li>His mobiile number is 012545466</li>"];
        var building2 = ["Building 2","<li>yellow colour</li><li>height-8m</li><li>Dr. Kelum</li>","<li>This is a yellow colour building</li><li>Height of this builing is 8m.</li><li>This building belongs to Dr. Kelum</li><li>His mobiile number is 064664646</li>"];
        var building3 = ["Building 3","<li>red colour</li><li>height-10m</li><li>Dr. Amal</li>","<li>This is a red colour building</li><li>Height of this builing is 10m.</li><li>This building belongs to Dr. Amal</li><li>His mobiile number is 46461331136</li>"];
        var building4 = ["Building 4","<li>green colour</li><li>height-10m</li><li>Dr. Chamindu</li>","<li>This is a green colour building</li><li>Height of this builing is 10m.</li><li>This building belongs to Dr. Chamindu</li><li>His mobiile number is 0164643</li>"];
        var building5 = ["Building 5","<li>orange colour</li><li>height-6m</li><li>Dr. Sujeewa</li>","<li>This is a orange colour building</li><li>Height of this builing is 6m.</li><li>This building belongs to Dr. Sujeewa</li><li>His mobiile number is 012540313</li>"];
        var building6 = ["Building 6","<li>pink colour</li><li>height-8m</li><li>Dr. Thamindu</li>","<li>This is a pink colour building</li><li>Height of this builing is 8m.</li><li>This building belongs to Dr. Thamindu</li><li>His mobiile number is 012986133032</li><li>This is a pink colour building</li><li>Height of this builing is 8m.</li><li>This building belongs to Dr. Thamindu</li><li>His mobiile number is 012986133032</li>"];

        departmentDatabase = [building0,building1,building2,building3,building4,building5,building6];
        

        //Scene
        var scene = new THREE.Scene();
        //Camera
        var camera = new THREE.PerspectiveCamera(85,window.innerWidth/(window.innerHeight*1.5));
        //Renderer
        var renderer = new THREE.WebGLRenderer({antilias:true});
        renderer.setSize(window.innerWidth*0.991,window.innerHeight*0.978);      
        $('body').append(renderer.domElement);    
        
        
//Creating Backgroud
        //Import images to the cube
        let materialArray = [];
        let texture_ft = new THREE.TextureLoader().load('./images/4.png');
        let texture_bk = new THREE.TextureLoader().load('./images/5.png');
        let texture_up = new THREE.TextureLoader().load('./images/2.png');
        let texture_dn = new THREE.TextureLoader().load('./images/6.png');
        let texture_rt = new THREE.TextureLoader().load('./images/3.png');
        let texture_lf = new THREE.TextureLoader().load('./images/1.png');

        materialArray.push(new THREE.MeshBasicMaterial({map: texture_ft}));
        materialArray.push(new THREE.MeshBasicMaterial({map: texture_bk}));
        materialArray.push(new THREE.MeshBasicMaterial({map: texture_up}));
        materialArray.push(new THREE.MeshBasicMaterial({map: texture_dn}));
        materialArray.push(new THREE.MeshBasicMaterial({map: texture_rt}));
        materialArray.push(new THREE.MeshBasicMaterial({map: texture_lf}));

        for(let i=0;i<6;i++){
            materialArray[i].side = THREE.BackSide;
        }

        let skyboxGeo = new THREE.BoxGeometry(1500,250,1500);       //Creats the backgroud cube
        let skybox = new THREE.Mesh(skyboxGeo, materialArray);
        scene.add(skybox);
        skybox.rotation.z -= Math.PI/2;         //Set the position of the cube
        skybox.position.set(119,0,0);


//Mouse Event Listeners
        const domEvents = new THREEx.DomEvents(camera,renderer.domEvents);
        function addMouseEvents(cube, buildingID){                                      //This function sets particular mouse event listeners to building objects
            domEvents.addEventListener(cube,'click',event => {                          //Click listener (Signals when user has clicked on the building)
                if(out==0){
                    if(clicked){                                                            //If user has already clicked (it means now he has clicked to unclick the previous click)
                            //Decrease the opacity of top right main information label to 0.5 
                        document.getElementById("hint").innerHTML = "Click on the building for more details";
                        document.getElementById("information").style.height = "40%";
                        document.getElementById("main_information").style.height = "75%";
                        document.getElementById("hint").style.height = "7.5%";
                        document.getElementById("controlLayout").style.height = "20%";
                        document.getElementById("more_information").style.removeProperty('min-height');
                        document.getElementById("more_information").style.padding = "0%";
                        document.getElementById("more_information").style.marginTop = "0%";
                        document.getElementById("more_information").style.margin = "0%";
                        document.getElementById("label2").style.fontSize = "0vmin";
                        document.getElementById("list2").style.fontSize = "0vmin";
                        cube.material.opacity = 0.6;
                        document.getElementById("label3").style.backgroundColor = "#1A5276";
                        showNavigator();
                        clicked = !clicked;                                                 //change the 'clicked' flag to 0
                    }else{                                                                  //If user hasn't clicked earlier
                            //Decrease the opacity of top right main information label to 0.5
                        document.getElementById("hint").innerHTML = "More details below â†“";
                        document.getElementById("information").style.height = "60%";
                        document.getElementById("main_information").style.height = "50%";
                        document.getElementById("hint").style.height = "5%";
                        document.getElementById("controlLayout").style.height = "80%";
                        document.getElementById("more_information").style.minHeight = "50%";
                        document.getElementById("more_information").style.padding = "5%";
                        document.getElementById("more_information").style.marginTop = "2.5%";
                        document.getElementById("more_information").style.margin = "1.5%";
                        document.getElementById("label2").style.fontSize = "2.8vmin";
                        document.getElementById("list2").style.fontSize = "2.15vmin";
                        cube.material.opacity = 0.9;
                        document.getElementById("label3").style.backgroundColor = "#5F6A6A";
                        hideNavigator();
                        clicked = !clicked;                                                 //change the 'clicked' flag to 1
                    }
                }
            });
            domEvents.addEventListener(cube,'mousemove',event => {                      //Onmousemove listener (Signals when mouse pointer is moving on the building)
                if(clicked==0 && out==0){                                                         //If user hasn't clicked some building (logic is when user has clicked on a particular building, data on the labels are not changing unitil he again clicks on that)
                    cube.material.opacity = 0.8;
                    document.getElementById("label").innerHTML = departmentDatabase[buildingID][0];                 //Update the particular information about the building appearing on the top right labels
                    document.getElementById("list").innerHTML = departmentDatabase[buildingID][1];
                    document.getElementById("list2").innerHTML = departmentDatabase[buildingID][2];
                }
            });    
            domEvents.addEventListener(cube,'mouseout',event => {                       //Onmouseout listener (Signals when mouse pointer is moving out from the building)
                if(clicked==0 && out==0){                                                         //If user hasn't clicked some building (logic is when user has clicked on a particular building, data on the labels are not changing unitil he again clicks on that)
                    cube.material.opacity = 0.6;
                    document.getElementById("label").innerHTML = departmentDatabase[0][0];                             //Update the default information about the department on the top right labels
                    document.getElementById("list").innerHTML = departmentDatabase[0][1];
                    document.getElementById("list2").innerHTML = departmentDatabase[0][2];
                }
            }); 
        }
    


//Import Blender Objects
        let buildingloader = new THREE.GLTFLoader();    //Create a loader to load the objects

        function importObject(location,xValue,yValue,zValue,xrotatevalue,scale=1){   //This function imports the blender object, sets the position, angle and adds to the scene
            var blenderBuilding;
            buildingloader.load(location,(gltf) => {
                blenderBuilding = gltf.scene;
                blenderBuilding.scale.set(scale,scale,scale);                                            //Set the scale of the object
                scene.add(blenderBuilding);                                                  //Add to the scene
                blenderBuilding.position.x = xValue;                                         //Set the position
                blenderBuilding.position.y = yValue;
                blenderBuilding.position.z = zValue;
                blenderBuilding.rotation.z = Math.PI/2;                                      //Set the rotation
                blenderBuilding.rotation.x = xrotatevalue;
                blenderBuilding.rotation.y = Math.PI;
                blenderBuilding.side = THREE.FrontSide;
            });
            return blenderBuilding;
        }
        

//Creating Transparent Objects
        var transparentMaterialArray = [];
        for(var i=0;i<7;i++){
            transparentMaterialArray[i] = new THREE.MeshBasicMaterial({color: 0x2758E7, transparent:true, opacity:0.6});
        }
        function createTransparentObject(buildingID,x,y,z,xPosition,yPosition,zPosition){
            var geometry = new THREE.BoxGeometry(x,y,z);
            var material = transparentMaterialArray[buildingID]
            var cube = new THREE.Mesh(geometry,material);
            scene.add(cube);
            cube.position.x = xPosition;
            cube.position.y = yPosition;
            cube.position.z = zPosition;
            addMouseEvents(cube,buildingID);
            return cube;
        }


//Set Lights
        function setDirectionalLight(X,Y,Z) {                           //This function set the light
            var lightId = new THREE.DirectionalLight(0xffffff,0.2); //Soft white light
            scene.add(lightId);                           //Add light to the scene
            lightId.position.set(X,Y,Z);
            return lightId;
        }

        function setPointLight(X,Y,Z) {                           //This function set the light
            var lightId = new THREE.PointLight(0xffffff,0.2); //Soft white light
            scene.add(lightId);                           //Add light to the scene
            lightId.position.set(X,Y,Z);
            return lightId;
        }


//Controls
        async function sleep(miliseconds){  //This function sleeps for particular time 
            return new Promise((resolve) => setTimeout(resolve,miliseconds));
        }

        var okToGoFront = 1, okToGoBack = 1;

        async function turnleft(){          //This function turns the camera to left by unit amount
            for(var i =0;i<10;i++){         //Used a loop for smooth movements
                await sleep(20);                        //Sleep for 20 millieseconds
                camera.rotation.x += Math.PI/200;       //Rotate the cmaera around x axis by 0.9 degrees to the left
                angle_x = angle_x + Math.PI/200;        //Update the new camera angle
                frontCameraBall.rotation.x += Math.PI/200;
                frontCameraBall.position.y = camera.position.y + (Math.sin(angle_x)*R);
                frontCameraBall.position.z = camera.position.z - (Math.cos(angle_x)*R);
                backCameraBall.rotation.x += Math.PI/200;
                backCameraBall.position.y = camera.position.y - (Math.sin(angle_x)*R);
                backCameraBall.position.z = camera.position.z + (Math.cos(angle_x)*R);
            }
        }
        async function turnright(){         //This function turns the camera to left by unit amount
            for(var i =0;i<10;i++){         //Used a loop for smooth movements
                await sleep(20);                        //Sleep for 20 millieseconds
                camera.rotation.x -= Math.PI/200;       //Rotate the camera around x axis by 0.9 degrees to the right
                angle_x = angle_x - Math.PI/200;        //Update the new camera angle
                frontCameraBall.rotation.x -= Math.PI/200;
                frontCameraBall.position.y = camera.position.y + (Math.sin(angle_x)*R);
                frontCameraBall.position.z = camera.position.z - (Math.cos(angle_x)*R);
                backCameraBall.rotation.x -= Math.PI/200;
                backCameraBall.position.y = camera.position.y - (Math.sin(angle_x)*R);
                backCameraBall.position.z = camera.position.z + (Math.cos(angle_x)*R);
            }
        }
        async function turnup(){            //This function turns the camera to left by unit amount
            for(var i =0;i<10;i++){         //Used a loop for smooth movements
                await sleep(20);                        //Sleep for 20 millieseconds
                camera.rotation.y -= Math.PI/200;       //Rotate the cmaera around y axis by 0.9 degrees to the up 
                angle_y = angle_y - Math.PI/200;        //Update the new camera angle
            }
        }
        async function turndown(){          //This function turns the camera to left by unit amount
            for(var i =0;i<10;i++){         //Used a loop for smooth movements
                await sleep(20);                        //Sleep for 20 millieseconds
                camera.rotation.y += Math.PI/200;       //Rotate the camera around y axis by 0.9 degrees to the down
                angle_y = angle_y + Math.PI/200;        //Update the new camera angle
            }
        }
        async function forward(){           //This function brings the camera to back by unit amount
            for(var i =0;i<10;i++){         //Used a loop for smooth movements                                    //Sleep for 20 millieseconds
                await sleep(20);
                if(okToGoFront){
                    camera.position.y += (Math.sin(angle_x)*S);      //Change the position of camera on y axis towards the facing direction
                    camera.position.z -= (Math.cos(angle_x)*S);      //Change the position of camera on z axis towards the facing direction
                    frontCameraBall.position.y += (Math.sin(angle_x)*S);
                    backCameraBall.position.y += (Math.sin(angle_x)*S);
                    frontCameraBall.position.z -= (Math.cos(angle_x)*S);
                    backCameraBall.position.z -= (Math.cos(angle_x)*S);
                }
            }
        }
        async function backward(){          //This function brings the camera to front by unit amount
            for(var i =0;i<10;i++){         //Used a loop for smooth movements
                await sleep(20);                                    //Sleep for 20 millieseconds
                if(okToGoBack){
                    camera.position.y -= (Math.sin(angle_x)*0.1);        //Change the position of camera on y axis towards the facing direction
                    camera.position.z += (Math.cos(angle_x)*0.1);        //Change the position of camera on z axis towards the facing direction
                    frontCameraBall.position.y -= (Math.sin(angle_x)*S);
                    backCameraBall.position.y -= (Math.sin(angle_x)*S);
                    frontCameraBall.position.z += (Math.cos(angle_x)*S);
                    backCameraBall.position.z += (Math.cos(angle_x)*S);
                }
            }    
        }


//Information Panel movements
        async function showInformation(){               //This function shrinks the top right main information label and makes the more information label appear
            if(clicked&&(!expanding)&&(!expanded)){     //If a building is clicked, labels are not expanding currently and more information label is dissappeared
                expanding=1;                            //set the expanding flag to 1
                document.getElementById("label2").innerHTML = "More information about "+document.getElementById("label").innerHTML;     //set the second label
                for(var i =0;i<10;i++){                 //Used a loop for smooth animations
                    await sleep(20);                    //Sleep for 20 millieseconds
                    document.getElementById("list").style.opacity = 1-(0.1*(i+1));                  //dissappears the main information list
                    document.getElementById("more_information").style.opacity = 0.09*(i+1);         //Shows the more information label
                    document.getElementById("main_information").style.height = 50-4.4*(i+1)+"%";   //Shrinks the main information label
                }
                document.getElementById("hint").style.backgroundColor = "#21618C";
                expanding=0;        //set the expanding flag to 0
                expanded = 1;       //Set the expanded flag to 1
            }
        }

        async function hideInformation(){               //This function expands the top right main information label and makes the more information label dissappear
            if(clicked&&(!expanding)&&expanded){        //If a building is clicked, labels are not expanding currently and more information label is appeared
                expanding=1;                            //set the expanding flag to 1
                document.getElementById("list").style.opacity = 1;      //Shows the main information list
                for(var i =0;i<10;i++){                 //Used a loop for smooth animations
                    await sleep(20);                    //Sleep for 20 millieseconds
                    document.getElementById("more_information").style.opacity = 0.9-0.09*(i+1);     //Dissappears the more information label
                    document.getElementById("main_information").style.height = 6+4.4*(i+1)+"%";    //Expands the main information label
                }
                document.getElementById("hint").style.backgroundColor = "#0B5345";
                expanding=0;            //set the expanding flag to 0
                expanded = 0;           //Set the expanded flag to 0
            }
        }

//Latter Panel movements
        async function hideNavigator(){
            for(var i =0;i<10;i++){                 //Used a loop for smooth animations
                    await sleep(20);                    //Sleep for 20 millieseconds
                    document.getElementById("navigator").style.height = 93 - (i+1)*8.6 + "%";     //Dissappears the more information label
                    document.getElementById("navigator").style.opacity = 0.9 - (i+1)*0.07;
                    document.getElementById("main_information").style.opacity = 0.6 + (i+1)*0.04;
                }
            document.getElementById("searchBar").style.opacity = 0;
        }
        async function showNavigator(){
            document.getElementById("searchBar").style.opacity = 1;
            for(var i =0;i<10;i++){                 //Used a loop for smooth animations
                    await sleep(20);                    //Sleep for 20 millieseconds
                    document.getElementById("navigator").style.height = 7 + (i+1)*8.6 + "%";     //Dissappears the more information label
                    document.getElementById("navigator").style.opacity = 0.2 + (i+1)*0.07;
                    document.getElementById("main_information").style.opacity = 1 - (i+1)*0.04;
                }
        }

//Camera Position
        async function changeView(){
            if(camera.position.x==0){
                document.getElementById("viewButton").innerHTML = "First Person";
                for(var i=0;i<10;i++){
                    await sleep(20);
                    camera.position.x=(i+1)*1;
                    camera.rotation.y = angle_y-(i+1)*((angle_y-Math.PI/8)/10); 
                }
                okToGoBack = 1;
                okToGoFront = 1;
                angle_y = Math.PI/8;
            }else{
                document.getElementById("viewButton").innerHTML = "Third Person";
                for(var i=0;i<10;i++){
                    await sleep(20);
                    camera.position.x=10-((i+1)*1);    //8,20
                    camera.rotation.y = angle_y-(i+1)*(angle_y/10);
                }
                okToGoBack = 0;
                okToGoFront = 0;
                angle_y = 0;
            }
        }

//Corner Controls
        function changeCorners(){
            if(circleCorners==1){
                circleCorners = 0;
                document.getElementById("changeCorners").innerHTML = "Circle Corners";
                document.getElementById("main_information").style.borderRadius = "0vmin";
                document.getElementById("hint").style.borderRadius = "0vmin";
                document.getElementById("more_information").style.borderRadius = "0vmin";
                document.getElementById("navigator").style.borderRadius = "0vmin";
                document.getElementById("changeCorners").style.borderRadius = "0vmin";
                document.getElementById("viewButton").style.borderRadius = "0vmin";
            }else{
                circleCorners = 1;
                document.getElementById("changeCorners").innerHTML = "Square Corners";
                document.getElementById("main_information").style.borderRadius = "3.5vmin 3.5vmin 0vmin 0vmin";
                document.getElementById("hint").style.borderRadius = "0vmin 0vmin 3.5vmin 3.5vmin";
                document.getElementById("more_information").style.borderRadius = "3.5vmin";
                document.getElementById("navigator").style.borderRadius = "3.5vmin 3.5vmin 0vmin 0vmin";
                document.getElementById("changeCorners").style.borderRadius = "1.65vmin";
                document.getElementById("viewButton").style.borderRadius = "1.65vmin";
            }
        }

//Changed
//Key Controls
        document.onkeydown = function(event){   //Set event listeners for key presses
            switch (event.keyCode){
                case 37:    //arrow left
                    turnleft();
                    break;
                case 38:    //Aroow up
                    forward();
                    break;
                case 39:    //Arrow right
                    turnright();
                    break;
                case 40:    //Arrow down
                    backward();
                    break;
                case 83:    //Letter s
                    turnup();
                    break;
                case 65:    //Letter a
                    turndown();
                    break;
            }
        }

//Transparent Walls
        function createWall(y,z,Y,Z){
            var geometry = new THREE.BoxGeometry(2,y,z);
            var material = new THREE.MeshBasicMaterial({color: 0x2758E7, transparent:true, opacity:0});
            var cube = new THREE.Mesh(geometry,material);
            scene.add(cube);
            cube.position.x = 0; //5
            cube.position.y = Y;
            cube.position.z = Z;
            let cubeBB = new THREE.Box3(new THREE.Vector3(),new THREE.Vector3());
            cubeBB.setFromObject(cube);
            return cubeBB;
        }

        function nowin(){
            out = 0;
        }
        function nowout(){
            out = 1;
        } 

        //var blenderBuilding9 = importObject('./without-door-panels/without-door-panels.gltf',-5,0,-80,0,3.28084);    //wall
        var blenderBuilding9 = importObject('./floors/ground-floor-updated.gltf',-5,0,-80,0,3.28084);    //wall


        //Creating transparent objects by using the created function above
        var cube1 = createTransparentObject(1,6.5617,2.6247,0.2,-1.72,-17.35,-40.4);
        var cube2 = createTransparentObject(2,6.5617,2.6247,0.2,-1.72,-17.35,-40.18);

        var cube3 = createTransparentObject(3,6.5617,2.6247,0.2,-1.72,-8.4,-58);
        var cube4 = createTransparentObject(4,6.5617,2.6247,0.2,-1.72,-8.4,-57.78);

        var cube5 = createTransparentObject(5,6.5617,0.2,2.6247,-1.72,-21.2,-51.5);
        var cube6 = createTransparentObject(6,6.5617,0.2,2.6247,-1.72,-20.95,-51.5);



        var cubeV1BB = createWall(Y,70,-0.2,-45);
        var cubeV2BB = createWall(Y,70,-30.8,-45);
        var cubeV3BB = createWall(Y,2,-22,-67);
        var cubeV4BB = createWall(Y,2,-19.2,-66.8);
        var cubeV5BB = createWall(Y,9,-19.2,-75.5);
        var cubeV6BB = createWall(Y,9.8,-11.2,-75.2);
        var cubeV7BB = createWall(Y,3.4,-11.2,-65.25);
        var cubeV8BB = createWall(Y,5.3,-11.2,-57.6);
        var cubeV9BB = createWall(Y,8.6,-6.1,-61.7);
        var cubeV10BB = createWall(Y,1.6,-21.1,-54); 
        var cubeV11BB = createWall(Y,21,-21.1,-39.5);
        var cubeV12BB = createWall(Y,2.1,-21.1,-25);
        var cubeV13BB = createWall(Y,10.8,-21.1,-15.4);
        var cubeV14BB = createWall(Y,11,-26,-25.2);
        var cubeV15BB = createWall(Y,1,-12.9,-19.8);
        var cubeV16BB = createWall(Y,5.5,-12.9,-13.2);
        var cubeV17BB = createWall(Y,0.8,-9.8,-10.3);
        var cubeV18BB = createWall(Y,11.3,-9.8,-19.75);
        var cubeV19BB = createWall(Y,10.5,-4.9,-20);
        var cubeV20BB = createWall(Y,5,-2.45,-17.5);
        var cubeV21BB = createWall(Y,5,-7.45,-17.5);

        var cubeH1BB = createWall(1,Y,-0.5,-10.2);
        var cubeH2BB = createWall(27,Y,-17.5,-10.2);
        var cubeH3BB = createWall(15.7,Y,-7.85,-40.2);
        var cubeH4BB = createWall(12,Y,-25,-40.2);
        var cubeH5BB = createWall(1,Y,-0.5,-25.1);
        var cubeH6BB = createWall(1.6,Y,-4.95,-25.1);
        var cubeH7BB = createWall(6,Y,-11.85,-25.1);
        var cubeH8BB = createWall(2.8,Y,-19.5,-25.1);
        var cubeH9BB = createWall(5,Y,-28.5,-25.4);
        var cubeH10BB = createWall(10,Y,-5,-14.9);
        var cubeH11BB = createWall(9.4,Y,-17.5,-20);
        var cubeH12BB = createWall(1,Y,-21.5,-30.4);
        var cubeH13BB = createWall(20,Y,-21,-55.1);
        var cubeH14BB = createWall(1,Y,-0.5,-57.8);
        var cubeH15BB = createWall(2.5,Y,-5.6,-57.8);
        var cubeH16BB = createWall(1,Y,-10.5,-57.8);
        var cubeH17BB = createWall(11,Y,-16.5,-65.8);
        var cubeH18BB = createWall(6,Y,-3,-65.1);
        var cubeH19BB = createWall(6.5,Y,-3.25,-70.2);
        var cubeH20BB = createWall(4,Y,-29,-67.9);
        var cubeH21BB = createWall(1.6,Y,-22.8,-67.9);
        var cubeH22BB = createWall(31,Y,-15.5,-79.8);

        //Front cube
        var frontCameraBall = new THREE.Mesh(
            new THREE.BoxGeometry(2,0.2,1),
            new THREE.MeshBasicMaterial({color: 0x2758E7, transparent:true, opacity:0})
        );
        scene.add(frontCameraBall);
        frontCameraBall.position.x = 0;
        frontCameraBall.position.y = 0;
        frontCameraBall.position.z = -R;
        let frontballBB = new THREE.Box3(new THREE.Vector3(),new THREE.Vector3());
        frontballBB.setFromObject(frontCameraBall);

        //Back cube
        var backCameraBall = new THREE.Mesh(
            new THREE.BoxGeometry(2,0.2,1),
            new THREE.MeshBasicMaterial({color: 0x2758E7, transparent:true, opacity:0})
        );
        scene.add(backCameraBall);
        backCameraBall.position.x = 0;
        backCameraBall.position.y = 0;
        backCameraBall.position.z = R;
        let backballBB = new THREE.Box3(new THREE.Vector3(),new THREE.Vector3());
        backballBB.setFromObject(backCameraBall);


     
        //Set lights by using the created function above

        var light1 = setPointLight(3,-5,-12.5);      //Blue
        var light2 = setPointLight(3,-11.5,-16);     //Yellow
        var light3 = setPointLight(3,-15.5,-23);     //Red
        var light4 = setPointLight(3,-17,-16);
        var light5 = setPointLight(3,-22.5,-25);
        var light6 = setPointLight(3,-26,-17);
        var light7 = setPointLight(3,-26,-33);
        var light8 = setPointLight(3,-5,-22.5);
        var light9 = setPointLight(3,-10.5,-32.5);
        var light10 = setPointLight(3,-26,-47.5);
        var light11 = setPointLight(3,-14,-47.5);
        var light11 = setPointLight(3,-21,-59);
        var light12 = setPointLight(3,-6,-73);
        var light13 = setPointLight(3,-15,-73);
        var light14 = setPointLight(3,-25,-74);
        //var light15 = setPointLight(1,-15,0);
        

        const lightt = new THREE.AmbientLight( 0x404040 ); // soft white light
        scene.add( lightt );


        //var lightD1 = setDirectionalLight(20,-10,-40);                                     //Use the function to set the light
        //setDirectionalLight(light2,0,50,-30);
        //setDirectionalLight(light3,20,-30,-10);
        //setDirectionalLight(light4,20,30,-10);

        camera.position.x = 0;              //Set the camera elevation (default value is 0)
        camera.rotation.z -= Math.PI/2;     //Set the rotation of the camera

        function checkCollision(){
            if(frontballBB.intersectsBox(cubeH1BB) || frontballBB.intersectsBox(cubeH2BB) || frontballBB.intersectsBox(cubeH3BB) || frontballBB.intersectsBox(cubeH4BB) || frontballBB.intersectsBox(cubeH5BB) || frontballBB.intersectsBox(cubeH6BB) || frontballBB.intersectsBox(cubeH7BB) || frontballBB.intersectsBox(cubeH8BB) || frontballBB.intersectsBox(cubeH9BB) || frontballBB.intersectsBox(cubeH10BB) || frontballBB.intersectsBox(cubeH11BB) || frontballBB.intersectsBox(cubeH12BB) || frontballBB.intersectsBox(cubeH13BB) || frontballBB.intersectsBox(cubeH14BB) || frontballBB.intersectsBox(cubeH15BB) || frontballBB.intersectsBox(cubeH16BB) || frontballBB.intersectsBox(cubeH17BB) || frontballBB.intersectsBox(cubeH18BB) || frontballBB.intersectsBox(cubeH19BB) || frontballBB.intersectsBox(cubeH20BB) || frontballBB.intersectsBox(cubeH21BB) || frontballBB.intersectsBox(cubeH22BB)){
                okToGoFront = 0;
            }else if(frontballBB.intersectsBox(cubeV1BB) || frontballBB.intersectsBox(cubeV2BB) || frontballBB.intersectsBox(cubeV3BB) || frontballBB.intersectsBox(cubeV4BB) || frontballBB.intersectsBox(cubeV5BB) || frontballBB.intersectsBox(cubeV6BB) || frontballBB.intersectsBox(cubeV7BB) || frontballBB.intersectsBox(cubeV8BB) || frontballBB.intersectsBox(cubeV9BB) || frontballBB.intersectsBox(cubeV10BB) || frontballBB.intersectsBox(cubeV11BB) || frontballBB.intersectsBox(cubeV12BB) || frontballBB.intersectsBox(cubeV13BB) || frontballBB.intersectsBox(cubeV14BB) || frontballBB.intersectsBox(cubeV15BB) || frontballBB.intersectsBox(cubeV16BB) || frontballBB.intersectsBox(cubeV17BB) || frontballBB.intersectsBox(cubeV18BB) || frontballBB.intersectsBox(cubeV19BB) || frontballBB.intersectsBox(cubeV20BB) || frontballBB.intersectsBox(cubeV21BB)){
                okToGoFront = 0;
            }else{
                okToGoFront = 1;
            }
            if(backballBB.intersectsBox(cubeH1BB) || backballBB.intersectsBox(cubeH2BB) || backballBB.intersectsBox(cubeH3BB) || backballBB.intersectsBox(cubeH4BB) || backballBB.intersectsBox(cubeH5BB) || backballBB.intersectsBox(cubeH6BB) || backballBB.intersectsBox(cubeH7BB) || backballBB.intersectsBox(cubeH8BB) || backballBB.intersectsBox(cubeH9BB) || backballBB.intersectsBox(cubeH10BB) || backballBB.intersectsBox(cubeH11BB) || backballBB.intersectsBox(cubeH12BB) || backballBB.intersectsBox(cubeH13BB) || backballBB.intersectsBox(cubeH14BB) || backballBB.intersectsBox(cubeH15BB) || backballBB.intersectsBox(cubeH16BB) || backballBB.intersectsBox(cubeH17BB) || backballBB.intersectsBox(cubeH18BB) || backballBB.intersectsBox(cubeH19BB) || backballBB.intersectsBox(cubeH20BB) || backballBB.intersectsBox(cubeH21BB) || backballBB.intersectsBox(cubeH22BB)){
                okToGoBack = 0;
            }else if(backballBB.intersectsBox(cubeV1BB) || backballBB.intersectsBox(cubeV2BB) || backballBB.intersectsBox(cubeV3BB) || backballBB.intersectsBox(cubeV4BB) || backballBB.intersectsBox(cubeV5BB) || backballBB.intersectsBox(cubeV6BB) || backballBB.intersectsBox(cubeV7BB) || backballBB.intersectsBox(cubeV8BB) || backballBB.intersectsBox(cubeV9BB) || backballBB.intersectsBox(cubeV10BB) || backballBB.intersectsBox(cubeV11BB) || backballBB.intersectsBox(cubeV12BB) || backballBB.intersectsBox(cubeV13BB) || backballBB.intersectsBox(cubeV14BB) || backballBB.intersectsBox(cubeV15BB) || backballBB.intersectsBox(cubeV16BB) || backballBB.intersectsBox(cubeV17BB) || backballBB.intersectsBox(cubeV18BB) || backballBB.intersectsBox(cubeV19BB) || backballBB.intersectsBox(cubeV20BB) || backballBB.intersectsBox(cubeV21BB)){
                okToGoBack = 0;
            }else{
                okToGoBack = 1;
            }
        }

//Rendering
        var animate = function(){
            
            frontballBB.copy(frontCameraBall.geometry.boundingBox).applyMatrix4(frontCameraBall.matrixWorld);
            backballBB.copy(backCameraBall.geometry.boundingBox).applyMatrix4(backCameraBall.matrixWorld);
            if(camera.position.x==0){
                checkCollision();
            }
            renderer.render(scene,camera);
            requestAnimationFrame(animate);
        };


        animate();

    </script>

    <div id="glass" class="glass" onmouseover="nowin()" onmouseleave="nowout()"></div>
    <div class="name"><strong>IDM</strong></div>
    <div class="controlLayoutColoured"></div>    <!--This is an invisible layout which used to sense mouse activities on the label-->
    <div id="information" class="information_class" >                    
        <div id ="main_information" class="main_information_class">                         <!--Top right main information label-->
            <p1 style="font-size: 3.3vmin;" id="label">Department Building</p1><br><br>
            <ul id="list" style="list-style-type:square; font-size: 2.15vmin;">                                   <!--Top right main information list-->
                <li>Welcome to Computer Engineering Department</li>
                <li>Head of the department is Mr.Rohitha</li>
                <li>This is a 4 story building</li>
            </ul>
        </div>
        <div id="hint" class="hint_class">Click on the building for more details</div>
        <div id="more_information" class="more_information_class">                          <!--Top right more information label-->
            <p2 id="label2" class="label2_class">More information here</p2>          
            <ul id="list2" class="list2_class" style="list-style-type:square;">                                             <!--Top right more information list-->
                <li>Welcome to Computer Engineering Department, University of Peradeniya.</li>
                <li>Head of the department is Mr.Rohitha (BsC .jhbasdvll)</li>
                <li>This is a 4 story building which has 4 labs and bla bla bla</li>
            </ul>
            <button id="moreButton" class="moreButton_class">More</button>
        </div>
    </div>
    
    <div id="latterPanel" class="latterPanelClass">
        <div id ="navigator" class="navigate_class">                         <!--Top right main information label-->
            <div id="searchBar" class="searchBar">
                <input id="searchQueryInput" class="searchQueryInput_class" type="text" name="searchQueryInput" placeholder="Search" value="" />
                <button id="searchQuerySubmit" class="searchQuerySubmit_class" type="submit" name="searchQuerySubmit">
                  <svg style="width:3.4vmin;height:3.4vmin" viewBox="0 0 24 24"><path fill="#666666" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
                  </svg>
                </button>
            </div>
        </div>
        <div style="font-size: 2.4vmin;" id="label3" class="label3_class">Navigator</div>
    </div>
    <div id="controlLayout" class="controlLayout_class" onmouseover="showInformation()" onmouseout="hideInformation()"></div>    <!--This is an invisible layout which used to sense mouse activities on the label-->
    <button class="changeCorners_class" id="changeCorners" onclick="changeCorners()">Square Corners</button>
    <button class="viewButtonClass" id="viewButton" onclick="changeView()">Third Person</button>
    <div class="aim"></div>
</body>
</html>